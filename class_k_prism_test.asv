% class k tensegrity dynamics with a prism example. 
[N,Cb,Cs] = tenseg_prism_sidestring(1);
B = N*Cb';S=N*Cs';b0=diag(diag(B'*B));s0=diag(diag(S'*S));
% fix the bottom 3 nodes to ground
P = [1 0 0;
     0 1 0;
     0 0 1;
     0 0 0;
     0 0 0;
     0 0 0];
D = [N(:,1) N(:,2) N(:,3)];

% external force on the structure
w1 = [0 0 -1]';w2 = [0 0 -1]';w3 = [0 0 -1]';w4 = [0 0 1]';w5 = [0 0 1]';w6 = [0 0 1]';
W = -1.*[w1 w2 w3 w4 w5 w6];

%% run the class K Dynamics
[U,E,V] = svd(P);
U1 = U(:,1:size(P,2));U2 = U(size(P,2)+1:end); E0 = E(1:size(P,2),:);
Nd = 0*N;
x0 = [N , Nd];
dt = 0.1; tf = 1;
t = 0:dt:tf;
Inp.Cs = Cs; Inp.Cb=Cb; Inp.W=W; Inp.s0=s0; Inp.b0=b0;Inp.tf=tf;Inp.P=P;Inp.D=D;Inp.B=B;Inp.S=S;
[t,y] = ode45(@dyn_class_k,t,x0,[],Inp);